<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Darwin: drwnPGM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="drwn.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Darwin
   &#160;<span id="projectnumber">1.10(beta)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">drwnPGM<div class="ingroups"><a class="el" href="group__drwnLibraries.html">Darwin Libraries</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="drwnPGMDef"></a>
Class List for drwnPGM</h1>
<ul>
<li><a class="el" href="classdrwnFactorGraph.html" title="Container and utility functions for factor graphs. ">drwnFactorGraph</a> : Container and utility functions for factor graphs. </li>
<li><a class="el" href="namespacedrwnFactorGraphUtils.html" title="Utility functions for factor graphs. ">drwnFactorGraphUtils</a> : Utility functions for factor graphs. </li>
<li><a class="el" href="classdrwnFactorOperation.html" title="Base class for implementing various operations on table factors. The derived classes store mappings b...">drwnFactorOperation</a> : Base class for implementing various operations on table factors. The derived classes store mappings between factor entries making them very fast for iterative algorithms. </li>
<li><a class="el" href="drwnVarAssignment_8h.html#a3e1bee985437ac5ac5565f4c713f57a9">drwnFullAssignment</a> : defines a complete assignment to all variables in the universe </li>
<li><a class="el" href="drwnGraphUtils_8h.html#drwnGraphUtils">drwnGraphUtils</a> : Generic graph utilities. </li>
<li><a class="el" href="classdrwnInference.html" title="Interface for various (marginal) inference algorithms. ">drwnInference</a> : Interface for various (marginal) inference algorithms. </li>
<li><a class="el" href="classdrwnMAPInference.html" title="Interface for various MAP inference (energy minimization) algorithms. ">drwnMAPInference</a> : Interface for various MAP inference (energy minimization) algorithms. </li>
<li><a class="el" href="classdrwnMAPInferenceFactory.html" title="Factory for creating drwnMAPInference objects. ">drwnMAPInferenceFactory</a> : Factory for creating <a class="el" href="classdrwnMAPInference.html" title="Interface for various MAP inference (energy minimization) algorithms. ">drwnMAPInference</a> objects. </li>
<li><a class="el" href="classdrwnMaxFlow.html" title="Interface for maxflow/min-cut algorithms (for minimizing submodular quadratic pseudo-Boolean function...">drwnMaxFlow</a> : Interface for maxflow/min-cut algorithms (for minimizing submodular quadratic pseudo-Boolean functions) </li>
<li><a class="el" href="classdrwnPartialAssignment.html" title="defines an assignment to a subset of the variables ">drwnPartialAssignment</a> : defines an assignment to a subset of the variables </li>
<li><a class="el" href="classdrwnTableFactor.html" title="Factor which stores the value of each assignment explicitly in table form. ">drwnTableFactor</a> : Factor which stores the value of each assignment explicitly in table form. </li>
<li><a class="el" href="classdrwnTableFactorMapping.html" title="Creates a mapping between entries in two tables. ">drwnTableFactorMapping</a> : Creates a mapping between entries in two tables. </li>
<li><a class="el" href="classdrwnVarUniverse.html" title="Data structure for definining the random variables (name and cardinality) for a given problem instanc...">drwnVarUniverse</a> : Data structure for definining the random variables (name and cardinality) for a given problem instance.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The current version of <b>Darwin</b> includes graphical model inference routines such as max-product message passing. Future release will also include learning algorithms for log-linear CRF models.</dd></dl>
<h1><a class="anchor" id="drwnMaxFlowDoc"></a>
Max-flow/Min-cut</h1>
<p><a class="el" href="classdrwnMaxFlow.html">drwnMaxFlow</a> and derived classes implement algorithms for solving the maxflow/mincut problem on directed graphs (see <a href="http://en.wikipedia.org/wiki/Max-flow_min-cut_theorem">http://en.wikipedia.org/wiki/Max-flow_min-cut_theorem</a>). This is particularly useful for minimizing submodular quadratic pseudo-Boolean functions.</p>
<p>The following example shows how to find the value of the minimum st-cut on a simple graph.</p>
<div class="dotgraph">
</div>
<div class="fragment"><div class="line"><a class="code" href="classdrwnEdmondsKarpMaxFlow.html">drwnEdmondsKarpMaxFlow</a> graph;  <span class="comment">// create graph</span></div><div class="line"></div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#aaf183c0ffd11677797e9b9f353f401df">addNodes</a>(5);             <span class="comment">// add five (internal) nodes</span></div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#a11f0c7f4b543ca2eba2f522ee19b32b8">addSourceEdge</a>(0, 3);     <span class="comment">// add edges from source</span></div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#a11f0c7f4b543ca2eba2f522ee19b32b8">addSourceEdge</a>(2, 3);</div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#af184483998d990df0ad92d66e5569ed6">addEdge</a>(0, 1, 4);        <span class="comment">// add internal edges</span></div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#af184483998d990df0ad92d66e5569ed6">addEdge</a>(1, 2, 1);</div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#af184483998d990df0ad92d66e5569ed6">addEdge</a>(1, 3, 2);</div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#af184483998d990df0ad92d66e5569ed6">addEdge</a>(2, 3, 2);</div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#af184483998d990df0ad92d66e5569ed6">addEdge</a>(2, 4, 6);</div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#a59f9ce5cd2f375ae355afe944cfdc8f9">addTargetEdge</a>(3, 1);     <span class="comment">// add edges to target (sink)</span></div><div class="line">graph.<a class="code" href="classdrwnMaxFlow.html#a59f9ce5cd2f375ae355afe944cfdc8f9">addTargetEdge</a>(4, 9);</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> mincut = graph.<a class="code" href="classdrwnEdmondsKarpMaxFlow.html#a0e6a49a4009d2fe5990130d090b07e55">solve</a>(); <span class="comment">// should be 5.0</span></div></div><!-- fragment --><h1><a class="anchor" id="drwnFactorDoc"></a>
Table Factors and Factor Operations</h1>
<p><b>Darwin</b> provide a suite of routines and datastructures for learning and inference in graphical models (or energy functions). Variables in the graphical model are defined by the <a class="el" href="classdrwnVarUniverse.html" title="Data structure for definining the random variables (name and cardinality) for a given problem instanc...">drwnVarUniverse</a> object. An instance of this object should be created once and shared between all objects in the graphical model.</p>
<p>The most basic entity in a graphical model is the factor. The <a class="el" href="classdrwnFactor.html" title="Generic interface for a factor. Currently only inherited by drwnTableFactor. ">drwnFactor</a> class defines the interface for factors. The derived <a class="el" href="classdrwnTableFactor.html" title="Factor which stores the value of each assignment explicitly in table form. ">drwnTableFactor</a> class provides storage for table factors, which explicitly store the value for each variable assignment. Operations on these factors are executed by classes derived from <a class="el" href="classdrwnFactorOperation.html" title="Base class for implementing various operations on table factors. The derived classes store mappings b...">drwnFactorOperation</a>. The advantage of using these classes is that they can cache mappings between table entries for fast execution in interative algorithms.</p>
<p>The following code provides an example of multiplying two factors and then marginalizing out one of the variables. Note that the variable names are optional and only provided for convenience&mdash;most large-scale applications will not make use of them and reference variables by index.</p>
<div class="fragment"><div class="line"><span class="comment">// define variables</span></div><div class="line"><a class="code" href="classdrwnSmartPointer.html">drwnVarUniversePtr</a> universe(<span class="keyword">new</span> <a class="code" href="classdrwnVarUniverse.html">drwnVarUniverse</a>());</div><div class="line">universe-&gt;addVariable(3, <span class="stringliteral">&quot;a&quot;</span>);   <span class="comment">// variable &quot;a&quot; has cardinality 3</span></div><div class="line">universe-&gt;addVariable(2, <span class="stringliteral">&quot;b&quot;</span>);   <span class="comment">// variable &quot;b&quot; has cardinality 2</span></div><div class="line">universe-&gt;addVariable(2, <span class="stringliteral">&quot;c&quot;</span>);   <span class="comment">// variable &quot;c&quot; has cardinality 2</span></div><div class="line"></div><div class="line"><span class="comment">// define factor over &quot;a&quot; and &quot;b&quot;</span></div><div class="line"><a class="code" href="classdrwnTableFactor.html">drwnTableFactor</a> psiA(universe);</div><div class="line">psiA.addVariable(<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, NULL);   <span class="comment">// or psiA.addVariable(1); psiA.addVariable(0);</span></div><div class="line">psiA[0] = 0.5; psiA[1] = 0.8; psiA[2] = 0.1;</div><div class="line">psiA[3] = 0.0; psiA[4] = 0.3; psiA[5] = 0.9;</div><div class="line"></div><div class="line"><span class="comment">// define factor over &quot;b&quot; and &quot;c&quot;</span></div><div class="line"><a class="code" href="classdrwnTableFactor.html">drwnTableFactor</a> psiB(universe);</div><div class="line">psiB.addVariables(<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, NULL);  <span class="comment">// or psiB.addVariable(2); psiB.addVariable(1);</span></div><div class="line">psiB[0] = 0.5; psiB[1] = 0.7;</div><div class="line">psiB[2] = 0.1; psiB[3] = 0.2;</div><div class="line"></div><div class="line"><span class="comment">// multiply factors together</span></div><div class="line"><a class="code" href="classdrwnTableFactor.html">drwnTableFactor</a> psiC(universe);</div><div class="line"><a class="code" href="classdrwnFactorProductOp.html">drwnFactorProductOp</a>(&amp;psiC, &amp;psiA, &amp;psiB).<a class="code" href="classdrwnFactorProductOp.html#a85be6368775f820774f56dd2bcf9af02">execute</a>();</div><div class="line"></div><div class="line"><span class="comment">// marginalize &quot;b&quot;</span></div><div class="line"><a class="code" href="classdrwnTableFactor.html">drwnTableFactor</a> psiD(universe);</div><div class="line"><a class="code" href="classdrwnFactorMarginalizeOp.html">drwnFactorMarginalizeOp</a>(&amp;psiD, &amp;psiC, universe-&gt;findVariable(<span class="stringliteral">&quot;b&quot;</span>)).execute();</div><div class="line"></div><div class="line"><span class="comment">// show results</span></div><div class="line">psiD.dump();</div></div><!-- fragment --><p>Factor operations can either be executed using temporary objects or, if executed multiple times, as named objects. For example the following two code segments have the save affect:</p>
<div class="fragment"><div class="line"><span class="comment">// operation using temporary object</span></div><div class="line">drwnPlusEqualsOp(&amp;sum, &amp;summand).execute();</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// operation using named object</span></div><div class="line">drwnPlusEqualsOp addOp(&amp;sum, &amp;summand);</div><div class="line">addOp.execute();</div></div><!-- fragment --><p>These operations form the basis of many of the inference routines (see <a class="el" href="group__drwnPGM.html#drwnInferenceDoc">Graphical Model Inference</a> and <a class="el" href="group__drwnPGM.html#drwnMapInferenceDoc">MAP Inference (Energy Minimization)</a>).</p>
<h1><a class="anchor" id="drwnInferenceDoc"></a>
Graphical Model Inference</h1>
<p>Graphical Model inference is conducted on factor graphs (<a class="el" href="classdrwnFactorGraph.html" title="Container and utility functions for factor graphs. ">drwnFactorGraph</a>) and involves computing marginals (or approximate marginals) on a structured probability distribution, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ P(x) \propto \prod_c \Psi_c(x_c) \]" src="form_7.png"/>
</p>
<p>The <a class="el" href="classdrwnInference.html" title="Interface for various (marginal) inference algorithms. ">drwnInference</a> class defines the interfaces for many of the inference algorithms implemented in <b>Darwin</b>. The following code snippet shows an example of loading a factor graph and running the sum-product inference algorithm on it.</p>
<div class="fragment"><div class="line"><span class="comment">// load graph</span></div><div class="line"><a class="code" href="classdrwnFactorGraph.html">drwnFactorGraph</a> graph;</div><div class="line">graph.<a class="code" href="classdrwnWriteable.html#abc63779bac847ca1d4dabfb45b236066">read</a>(filename);</div><div class="line"></div><div class="line"><span class="comment">// run inference</span></div><div class="line"><a class="code" href="classdrwnSumProdInference.html">drwnSumProdInference</a> inf(graph);</div><div class="line">inf.inference();</div><div class="line"></div><div class="line"><span class="comment">// show marginal over the first variable</span></div><div class="line"><a class="code" href="classdrwnTableFactor.html">drwnTableFactor</a> belief = inf[0];</div><div class="line">belief.<a class="code" href="classdrwnWriteable.html#abe836316bc4b43a28f820a9978c80918">dump</a>();</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__drwnPGM.html#drwnMapInferenceDoc">MAP Inference (Energy Minimization)</a></dd></dl>
<h1><a class="anchor" id="drwnMapInferenceDoc"></a>
MAP Inference (Energy Minimization)</h1>
<p>MAP Inference is conducted on factor graphs where each factor is defined in (negative) log-space, i.e., energy space,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ P(x) \propto \exp\{-E(x)\} \textrm{ where } E(x) = \sum_c \psi_c(x_c) \]" src="form_8.png"/>
</p>
<p>Unlike <a class="el" href="group__drwnPGM.html#drwnInferenceDoc">Graphical Model Inference</a>, the goal of MAP Inference is to find the joint assignment to the variables with highest probability (lowest energy). The interface for MAP inference is defined by the <a class="el" href="classdrwnMAPInference.html" title="Interface for various MAP inference (energy minimization) algorithms. ">drwnMAPInference</a> class. Currently <b>Darwin</b> implements the following algorithms:</p>
<ul>
<li>exact inference using the junction-tree algorithm (see <a class="el" href="classdrwnJunctionTreeInference.html" title="Implements the junction tree algorithm for exact inference on a factor graph using drwnAsyncMaxProdIn...">drwnJunctionTreeInference</a>) </li>
<li>iterated conditional modes (see <a class="el" href="classdrwnICMInference.html" title="Implements iterated conditional modes (ICM) MAP inference. This method was first proposed in Besag...">drwnICMInference</a>) </li>
<li>synchronous and asychronous max-product belief propagation (see <a class="el" href="classdrwnMaxProdInference.html" title="Implements max-product inference. ">drwnMaxProdInference</a> and <a class="el" href="classdrwnAsyncMaxProdInference.html" title="Implements asynchronous max-product (min-sum) inference. ">drwnAsyncMaxProdInference</a>) </li>
<li>sequential tree-reweighted message passing (see <a class="el" href="classdrwnTRWSInference.html" title="Implements the sequential tree-reweighted message passing (TRW-S) algorithm described in &quot;Convergent ...">drwnTRWSInference</a>) </li>
<li>Globerson and Jaakkola's GEMPLP (see <a class="el" href="classdrwnGEMPLPInference.html" title="Implements the generalized LP-based message passing algorithm of Globerson and Jaakkola, NIPS 2007. ">drwnGEMPLPInference</a>) </li>
<li>Sontag et al.'s iterative tightening of GEMPLP (see <a class="el" href="classdrwnSontag08Inference.html" title="Implements the incremental tightening of the LP MAP inference algorithm from Sontag et al...">drwnSontag08Inference</a>) </li>
<li>Komodakis' dual decomposition inference (see <a class="el" href="classdrwnDualDecompositionInference.html" title="Implements dual decomposition MAP inference (see Komodakis and Paragios, CVPR 2009 and works cited th...">drwnDualDecompositionInference</a>) </li>
<li>Alpha-Expansion and Alpha-Beta Swap (see <a class="el" href="classdrwnAlphaExpansionInference.html" title="Implements alpha-expansion inference using graph-cuts (see Boykov et al, 2001). Factor graphs must be...">drwnAlphaExpansionInference</a> and <a class="el" href="classdrwnAlphaBetaSwapInference.html" title="Implements alpha-beta swap inference using graph-cuts (see Boykov et al, 2001). Factor graphs must be...">drwnAlphaBetaSwapInference</a>) </li>
<li>Meshi and Globerson's alternating directions method (see <a class="el" href="classdrwnADLPInference.html" title="Implements the alternating direction method algorithm described in &quot;An Alternating Direction Method f...">drwnADLPInference</a>)</li>
</ul>
<p>The following code snippet shows an example of running the max-product algorithm on a factor graph.</p>
<div class="fragment"><div class="line"><span class="comment">// load graph</span></div><div class="line"><a class="code" href="classdrwnFactorGraph.html">drwnFactorGraph</a> graph;</div><div class="line">graph.<a class="code" href="classdrwnWriteable.html#abc63779bac847ca1d4dabfb45b236066">read</a>(filename);</div><div class="line"></div><div class="line"><span class="comment">// run MAP inference</span></div><div class="line"><a class="code" href="classdrwnMaxProdInference.html">drwnMaxProdInference</a> mp(graph);</div><div class="line"><a class="code" href="drwnVarAssignment_8h.html#a3e1bee985437ac5ac5565f4c713f57a9">drwnFullAssignment</a> assignment;</div><div class="line">pair&lt;double, double&gt; e = mp.inference(assignment);</div><div class="line">DRWN_LOG_MESSAGE(<span class="stringliteral">&quot;map assignment has energy &quot;</span> &lt;&lt; e.first);</div><div class="line"><span class="keywordflow">if</span> (e.second != -DRWN_DBL_MAX) {</div><div class="line">    DRWN_LOG_MESSAGE(<span class="stringliteral">&quot;lower bound energy is &quot;</span> &lt;&lt; e.second);</div><div class="line">}</div><div class="line">DRWN_LOG_VERBOSE(<span class="stringliteral">&quot;map assignment is &quot;</span> &lt;&lt; <a class="code" href="drwnStrUtils_8h.html#a73ae7e986e8c63298610d330578f5b74">toString</a>(assignment));</div></div><!-- fragment --><p>The <a class="el" href="drwnProjRosetta.html">MAP Inference for Rosetta Protein Design</a> demonstrates these algorithms on the Rosetta Protein Design dataset.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__drwnPGM.html#drwnInferenceDoc">Graphical Model Inference</a> </dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed May 7 2025 09:52:24 for Darwin by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
